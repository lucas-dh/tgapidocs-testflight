# 可视域分析操作

## 目录

- [1.添加可视域分析](#1添加可视域分析-流)
- [2.更新可视域分析](#2更新可视域分析-流)
- [3.更新可视域分析样式](#3更新可视域分析样式-流)
- [4.删除可视域分析](#4删除可视域分析-流)

## 1.添加可视域分析 <span style="width: 40px;height: 21px;display:inline-block;background: #0fcccc;margin-left: 5px;line-height: 19px;"><span style="width: 100%;height: 100%;background: url(./img/stream.png) no-repeat 4px 5px;background-size: 12px 10px;text-indent: 22px;font-size: 12px;color: #ffffff;line-height: 20px;display:inline-block;vertical-align: top;">流</span></span>

### 功能描述

在三维场景中添加可视域分析

### 调用方法

```js
let jsonData = {
  id: 'viewshed',
  coordType: 0,
  coordTypeZ: 0, 
  coord: [103.995697,1.399239],
  coordZ: 150,
  visible: true,
  angleH: 10,
  angleV: 10,
  distance: 100,
  rotation: [20,80,90],
  alpha: 0.5,
  outline: true,
  outlineColor: '#ffffff',
};

appInstance.uniCall('addViewshed', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性             | 类型     | 说明                                                                                                                                      
| ---------------- | -------- | ----------------------------------------------------------------------------------------------------------------------------------------- 
| id               | String   | 对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                                         
| coordType        | Number   | XY 轴坐标类别，0：X 经度，Y 纬度；1：X 米，Y米，相对世界00点                                                                         
| coordTypeZ       | Number   | Z 轴坐标类别，0：相对 3D 世界 0 海拔；1：相对 3D 世界地表；2：相对 3D 模型表面（单位：米）                                               
| coord            | Array    | XY 轴坐标，X：经度；Y：纬度                                                                                                          
| coordZ           | Number   | Z 轴高度（单位：米）                                                                                                                 
| visible          | Boolean  | 初始化添加时的默认值，true：显示，false：隐藏                                                                                       
| angleH           | Number   | 可视域横向夹角，（单位：角度，0.1 - 180）                                                                                         
| angleV           | Number   | 可视域纵向夹角，（单位：角度，0.1 - 360）                                                                                     
| distance         | Number   | 可视域距离，（单位：米）                                                                                                       
| rotation         | Array    | XYZ 三轴旋转度数 [偏航角（单位：角度，0正北, -360 ~ 360）, 俯仰角（单位：角度，0水平, -360 ~ 360）,翻滚角（单位：角度，0水平, -360 ~ 360）]       
| alpha            | Number   | 可视域透明度，0：完全透明；1：完全不透明                                                                                         
| outline          | Boolean  | 是否显示可视域描边                                                                                              
| outlineColor     | String   | 描边颜色                                                                                                       

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 2.更新可视域分析 <span style="width: 40px;height: 21px;display:inline-block;background: #0fcccc;margin-left: 5px;line-height: 19px;"><span style="width: 100%;height: 100%;background: url(./img/stream.png) no-repeat 4px 5px;background-size: 12px 10px;text-indent: 22px;font-size: 12px;color: #ffffff;line-height: 20px;display:inline-block;vertical-align: top;">流</span></span>

### 功能描述

更新三维场景中添加可视域分析的数据

### 调用方法

```js
let jsonData = {
  id: 'viewshed',
  coordType: 0,
  coordTypeZ: 0, 
  coord: [103.995697,1.399239],
  coordZ: 150,
  angleH: 10,
  angleV: 10,
  distance: 100,
  rotation: [20,80,90],
};

appInstance.uniCall('updateViewshed', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性             | 类型     | 说明                                                                                                                  
| ---------------- | -------- | --------------------------------------------------------------------------------------------------------------------- 
| id               | String   | 对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                   
| coordType        | Number   | XY 轴坐标类别，0：X 经度，Y 纬度；1：X 米，Y米，相对世界00点                                                     
| coordTypeZ       | Number   | Z 轴坐标类别，0：相对 3D 世界 0 海拔；1：相对 3D 世界地表；2：相对 3D 模型表面（单位：米）                             
| coord            | Array    | XY 轴坐标，X：经度；Y：纬度                                                                                    
| coordZ           | Number   | Z 轴高度（单位：米）                                                                                           
| angleH           | Number   | 可视域横向夹角，（单位：角度，0.1 - 180）                                                                        
| angleV           | Number   | 可视域纵向夹角，（单位：角度，0.1 - 360）                                                                       
| distance         | Number   | 可视域距离，（单位：米）                                                                                                 
| rotation         | Array    | XYZ 三轴旋转度数 [偏航角（单位：角度，0正北, -360 ~ 360）, 俯仰角（单位：角度，0水平, -360 ~ 360）,翻滚角（单位：角度，0水平, -360 ~ 360）]    

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 3.更新可视域分析样式 <span style="width: 40px;height: 21px;display:inline-block;background: #0fcccc;margin-left: 5px;line-height: 19px;"><span style="width: 100%;height: 100%;background: url(./img/stream.png) no-repeat 4px 5px;background-size: 12px 10px;text-indent: 22px;font-size: 12px;color: #ffffff;line-height: 20px;display:inline-block;vertical-align: top;">流</span></span>

### 功能描述

更新三维场景中添加可视域分析的样式

### 调用方法

```js
let jsonData = {
  id: 'viewshed',
  alpha: 0.5,
  outline: true,
  outlineColor: '#ffffff',

};

appInstance.uniCall('updateViewshedStyle', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性         | 类型   | 说明                                                                                                                                      
| ------------ | ------ | ----------------------------------------------------------------------------------------------------------------------------------------- 
| id           | String  | 图层对象 id，更新时调用者自己传入的唯一标识                                                  
| alpha        | Number  | 可视域透明度，0：完全透明；1：完全不透明                                                    
| outline      | Boolean | 是否显示可视域描边                                                                         
| outlineColor | String  | 描边颜色                                                                                   

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 4.删除可视域分析 <span style="width: 40px;height: 21px;display:inline-block;background: #0fcccc;margin-left: 5px;line-height: 19px;"><span style="width: 100%;height: 100%;background: url(./img/stream.png) no-repeat 4px 5px;background-size: 12px 10px;text-indent: 22px;font-size: 12px;color: #ffffff;line-height: 20px;display:inline-block;vertical-align: top;">流</span></span>

### 功能描述

删除三维场景中的可视域分析

### 调用方法

```js
let jsonData = {
  id: 'viewshed', 
};

appInstance.uniCall('removeModel', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性         | 类型   | 说明                                                                                                                                      
| ------------ | ------ | ----------------------------------------------------------------------------------------------------------------------------------------- 
| id           | String  | 图层对象 id，更新时调用者自己传入的唯一标识                                                                                  

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)