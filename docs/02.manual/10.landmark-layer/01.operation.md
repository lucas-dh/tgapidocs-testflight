# 地标图操作

## 目录

- [1.添加地标图](#1添加地标图)
- [2.更新地标图数据](#2更新地标图数据)
- [3.更新地标图样式](#3更新地标图样式)
- [4.删除地标图](#4删除地标图)
- [5.添加 Shp 地标图](#5添加shp地标图-端)

## 1.添加地标图

### 功能描述

在三维场景中添加地标图

### 调用方法

```js
let jsonData = {
  id: 'landmarkLayer',
  name: '地标图层',
  coordType: 0,
  coordTypeZ: 0,
  autoScale: false,
  visible: true,
  tags: ["tag1", "tag2", "tag3"],
  legends: [
    {
      name: '摄像头',
      color: '#73FFFF',
      iconName: 'camera',
      iconScale: 1,
      labelScale: 1，
    },
    {
      name: 'WIFI热点',
      color: '#2626FF',
      iconName: 'wifi',
      iconScale: 1,
      labelScale: 1，
    },
  ],
  data: [
    {
      id: '1',
      type: '摄像头',
      label: '摄像头1',
      coord: [113.934429644472, 22.5105568002601], //以深圳湾经纬度为例
      coordZ: 100,
    },
    {
      id: '2',
      type: '摄像头',
      label: '摄像头2',
      coord: [113.933593837038, 22.5099344521292],
      coordZ: 100,
    },
    {
      id: '3',
      type: '摄像头',
      label: '摄像头3',
      coord: [113.936979866625, 22.511939613347902],
      coordZ: 100,
    },
    {
      id: '4',
      type: '摄像头',
      label: '摄像头4',
      coord: [113.935147516865, 22.5123693181349],
      coordZ: 100,
    },
    {
      id: '5',
      type: '摄像头',
      label: '摄像头5',
      coord: [113.93276891595, 22.5104320222378],
      coordZ: 100,
    },
    {
      id: '6',
      type: 'WIFI热点',
      label: 'WIFI热点1',
      coord: [113.933326095652, 22.5115899172958],
      coordZ: 60,
    },
    {
      id: '7',
      type: 'WIFI热点',
      label: 'WIFI热点2',
      coord: [113.932480299133, 22.5104125714032],
      coordZ: 60,
    },
    {
      id: '8',
      type: 'WIFI热点',
      label: 'WIFI热点3',
      coord: [113.932705105515, 22.508776193495404],
      coordZ: 60,
    },
    {
      id: '9',
      type: 'WIFI热点',
      label: 'WIFI热点4',
      coord: [113.931762182516, 22.511235896344402],
      coordZ: 60,
    },
    {
      id: '10',
      type: 'WIFI热点',
      label: 'WIFI热点5',
      coord: [113.931365756868, 22.510176666936403],
      coordZ: 60,
    },
  ],
};

appInstance.uniCall('addLandmarkLayer', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

以下是修改后的表格，新增了"端渲染"和"流渲染"两列：

| 属性                  | 类型    | 说明                                                                                                                  | 端渲染 | 流渲染 |
| --------------------- | ------- | --------------------------------------------------------------------------------------------------------------------- | ------ | ------ |
| id                    | String  | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                   | 支持   | 支持   |
| name                  | String  | 图层名称，支持为图层自定义名称                                                                                        | 支持   | 支持   |
| coordType             | Number  | xy 轴坐标模式 坐标类型(0:x 经度 y 纬度；1:x 米 y 米，相对世界 00 点) 目前该属性仅支持属性值为 0                       | 支持   | 支持   |
| coordTypeZ            | Number  | Z 轴坐标类别，0：相对 3D 世界 0 海拔；1：相对 3D 世界地表；2：相对 3D 模型表面（单位：米） 目前该属性仅支持属性值为 0 | 支持   | 支持   |
| autoScale             | Boolean | 默认 false, 如果开启 true 后，图标会按照摄像机远近自动缩放大小                                                        | 支持   | 支持   |
| visible               | Boolean | 添加当前图层时默认显示还是隐藏                                                                                        | 支持   | 支持   |
| tags                  | Array   | 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐                                                            | 不支持 | 支持   |
| legends               | Array   | 定义图层包含图例，支持为不同图例定义各自样式                                                                          | 支持   | 支持   |
| legends[0].name       | String  | 图层内图例名称，新建时调用者自己传入的唯一名称，用于各种操作的图例识别                                                | 支持   | 支持   |
| legends[0].color      | String  | 颜色（HEX 颜色值）                                                                                                    | 支持   | 支持   |
| legends[0].iconName   | String  | 内置图标名称，具体图标名称参考下表和下图                                                                              | 支持   | 支持   |
| legends[0].iconScale  | Number  | 默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                                        | 支持   | 支持   |
| legends[0].labelScale | Number  | 默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                                        | 支持   | 支持   |
| data                  | Array   | 数据点位基本信息集合                                                                                                  | 支持   | 支持   |
| data[0].id            | String  | 图层子对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                 | 支持   | 支持   |
| data[0].label         | String  | 图标标签文本                                                                                                          | 支持   | 支持   |
| data[0].coord         | Array   | XY 轴坐标，X：经度；Y：纬度                                                                                           | 支持   | 支持   |
| data[0].coordZ        | Number  | Z 轴高度（单位：米）                                                                                                  | 支持   | 支持   |
| data[0].type          | String  | 地标点的图例类别名称                                                                                                  | 支持   | 支持   |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

### 具体内置图标名称（iconName）详情

<table>
    <tr>
      <th>图标类型</th>
      <th>图标名称</th>
    </tr>
    <tr>
      <td rowspan="15" style="text-align:left;">市政设施</td>
      <td>camera</td>
    </tr>
    <tr>
      <td>streetlamp</td>
    </tr>
    <tr>
      <td>manholecover</td>
    </tr>
    <tr>
      <td>sensor</td>
    </tr>
    <tr>
      <td>utilitypole</td>
    </tr>
    <tr>
      <td>transmission</td>
    </tr>
    <tr>
      <td>broadcast</td>
    </tr>
    <tr>
      <td>wifi</td>
    </tr>
    <tr>
      <td>firehydrant</td>
    </tr>
    <tr>
      <td>equipmentbox</td>
    </tr>
    <tr>
      <td>trafficlight</td>
    </tr>
    <tr>
      <td>charge</td>
    </tr>
    <tr>
      <td>gasstation</td>
    </tr>
    <tr>
      <td>wc</td>
    </tr>
    <tr>
      <td>dustbin</td>
    </tr>
    <tr>
      <td rowspan="20" style="text-align:left;">地点建筑</td>
      <td>trainstation</td>
    </tr>
    <tr>
      <td>airport</td>
    </tr>
    <tr>
      <td>anchor</td>
    </tr>
    <tr>
      <td>government</td>
    </tr>
    <tr>
      <td>netpoint</td>
    </tr>
    <tr>
      <td>metro</td>
    </tr>
    <tr>
      <td>finance</td>
    </tr>
    <tr>
      <td>school</td>
    </tr>
    <tr>
      <td>hospital</td>
    </tr>
    <tr>
      <td>factory</td>
    </tr>
    <tr>
      <td>constructionsite</td>
    </tr>
    <tr>
      <td>residence</td>
    </tr>
    <tr>
      <td>mergencyshelter</td>
    </tr>
    <tr>
      <td>park</td>
    </tr>
    <tr>
      <td>diningroom</td>
    </tr>
    <tr>
      <td>warehouse</td>
    </tr>
    <tr>
      <td>store</td>
    </tr>
    <tr>
      <td>tollgate</td>
    </tr>
    <tr>
      <td>officebuilding</td>
    </tr>
    <tr>
      <td>busstation</td>
    </tr>
    <tr>
      <td rowspan="5" style="text-align:left;">人员</td>
      <td>people</td>
    </tr>
    <tr>
      <td>policeman</td>
    </tr>
    <tr>
      <td>doctor</td>
    </tr>
    <tr>
      <td>specialpeople</td>
    </tr>
    <tr>
      <td>criminal</td>
    </tr>
    <tr>
      <td rowspan="15" style="text-align:left;">交通</td>
      <td>car</td>
    </tr>
    <tr>
      <td>policecar</td>
    </tr>
    <tr>
      <td>fireengine</td>
    </tr>
    <tr>
      <td>ambulance</td>
    </tr>
    <tr>
      <td>taxi</td>
    </tr>
    <tr>
      <td>truck</td>
    </tr>
    <tr>
      <td>bus</td>
    </tr>
    <tr>
      <td>newscar</td>
    </tr>
    <tr>
      <td>militarycar</td>
    </tr>
    <tr>
      <td>municipal</td>
    </tr>
    <tr>
      <td>electriccar</td>
    </tr>
    <tr>
      <td>watercar</td>
    </tr>
    <tr>
      <td>train</td>
    </tr>
    <tr>
      <td>ship</td>
    </tr>
    <tr>
      <td>cargoship</td>
    </tr>
    <tr>
      <td rowspan="5" style="text-align:left;">飞行器</td>
      <td>airplane</td>
    </tr>
    <tr>
      <td>helicopter</td>
    </tr>
    <tr>
      <td>uav</td>
    </tr>
    <tr>
      <td>satellite</td>
    </tr>
    <tr>
      <td>rocket</td>
    </tr>
    <tr>
      <td rowspan="3" style="text-align:left;">事件</td>
      <td>event_01</td>
    </tr>
    <tr>
      <td>event_02</td>
    </tr>
    <tr>
      <td>event_03</td>
    </tr>
    <tr>
      <td rowspan="4" style="text-align:left;">通用</td>
      <td>icon_01</td>
    </tr>
    <tr>
      <td>icon_02</td>
    </tr>
    <tr>
      <td>icon_03</td>
    </tr>
    <tr>
      <td>icon_04</td>
    </tr>
    <tr>
      <td rowspan="3" style="text-align:left;">地名</td>
      <td>site_01</td>
    </tr>
    <tr>
      <td>site_02</td>
    </tr>
    <tr>
      <td>site_03</td>
    </tr>
</table>

### 具体内置图标名称（iconName）效果

<img src="./contents/mediaFiles/images/iconName.jpg" width = "1344" height = "765" alt="图标效果" />

[返回本章目录](#目录)

## 2.更新地标图数据

### 功能描述

更新三维场景中添加地标图的数据

### 调用方法

```js
let jsonData = {
  id: 'landmarkLayer',
  name: '地标图层',
  coordType: 0,
  coordTypeZ: 0,
  isAppend: false,
  tags: ['tag1', 'tag2', 'tag3'],
  data: [
    {
      id: '11',
      type: '摄像头',
      label: '摄像头',
      coord: [113.932358252279, 22.513687693448002], //以深圳湾经纬度为例
      coordZ: 64,
    },
    {
      id: '12',
      type: '摄像头',
      label: '摄像头',
      coord: [113.934061940271, 22.513951407881102],
      coordZ: 64,
    },
    {
      id: '13',
      type: '摄像头',
      label: '摄像头',
      coord: [113.930654568696, 22.511470933294802],
      coordZ: 64,
    },
  ],
};

appInstance.uniCall('updateLandmarkLayerCoord', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性           | 类型    | 说明                                                                                                                  | 端渲染 | 流渲染 |
| -------------- | ------- | --------------------------------------------------------------------------------------------------------------------- | ------ | ------ |
| id             | String  | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                   | 支持   | 支持   |
| name           | String  | 图层名称，支持为图层自定义名称                                                                                        | 支持   | 支持   |
| coordType      | Number  | xy 轴坐标模式 坐标类型(0:x 经度 y 纬度；1:x 米 y 米，相对世界 00 点) 目前该属性仅支持属性值为 0                       | 支持   | 支持   |
| coordTypeZ     | Number  | Z 轴坐标类别，0：相对 3D 世界 0 海拔；1：相对 3D 世界地表；2：相对 3D 模型表面（单位：米） 目前该属性仅支持属性值为 0 | 支持   | 支持   |
| isAppend       | Boolean | 是否追加数据（按顺序），true：按新数据 更新原有重复数据 & 追加新数据；false：清除原有数据 & 重建新数据                | 支持   | 支持   |
| tags           | Array   | 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐                                                            | 不支持 | 支持   |
| data           | Array   | 定义图层可视化数据                                                                                                    | 支持   | 支持   |
| data[0].id     | String  | 图层子对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                 | 支持   | 支持   |
| data[0].coord  | Array   | XY 轴坐标，X：经度；Y：纬度                                                                                           | 支持   | 支持   |
| data[0].coordZ | Number  | Z 轴高度（单位：米）                                                                                                  | 支持   | 支持   |
| data[0].type   | String  | 地标点的图例类别名称                                                                                                  | 支持   | 支持   |
| data[0].label  | String  | 图标标签文本                                                                                                          | 支持   | 支持   |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 3.更新地标图样式

### 功能描述

更新三维场景中添加地标图的样式

### 调用方法

```js
let jsonData = {
  id: 'landmarkLayer',
  isAppend: true,
  legends: [
    {
      name: '摄像头',
      color: '#00ef00',
      iconName: 'firehydrant',
      iconScale: 1,
      labelScale: 1,
    },
    {
      name: 'WIFI热点',
      color: '#00ad00',
      iconName: 'streetlamp',
      iconScale: 1,
      labelScale: 1,
    },
  ],
};

appInstance.uniCall('updateLandmarkLayerStyle', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性                  | 类型    | 说明                                                                                                   |
| --------------------- | ------- | ------------------------------------------------------------------------------------------------------ |
| id                    | String  | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                    |
| isAppend              | Boolean | 是否追加数据（按顺序），true：按新数据 更新原有重复数据 & 追加新数据；false：清除原有数据 & 重建新数据 |
| legends               | Array   | 图例图层定义                                                                                           |
| legends[0].name       | String  | 图标对象名称，和数据集合中 type 属性对应，本身也可以代表内置的图标名称                                 |
| legends[0].color      | String  | 图标颜色设置                                                                                           |
| legends[0].iconName   | String  | 内置图标名称                                                                                           |
| legends[0].iconScale  | Number  | 默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                         |
| legends[0].labelScale | Number  | 默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                         |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 4.删除地标图

### 功能描述

删除地标图

### 调用方法

```js
let jsonData = {
  id: 'landmarkLayer',
  overlayType: 'landmarkLayer',
};

appInstance.uniCall('removeOverlay', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型   | 说明                                                                |
| ----------- | ------ | ------------------------------------------------------------------- |
| id          | String | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别 |
| overlayType | String | 图层对象类别                                                        |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

### 流渲染效果图

<img src="./contents/mediaFiles/images/landmarkLayer/landmarkLayer-Streaming.jpg"  width = "544" height="405"  alt="系统架构图" />

### 端渲染效果图

<img src="./contents/mediaFiles/images/landmarkLayer/landmarkImg.jpg"  width = "544" height="405" alt="系统架构图" />

[返回本章目录](#目录)

## 5.添加 shp 地标图 <span style="width: 40px;height: 21px;display:inline-block;background: #1177e3;margin-left: 5px;font-size: 12px;line-height: 28px;"><span style="width: 100%;height: 100%;background: url(./img/duan.png) no-repeat 4px 5px;background-size: 11px 10px;text-indent: 22px;font-size: 12px;color: #ffffff;line-height: 21px;display:inline-block;vertical-align: top;">端</span></span>

### 功能描述

在三维场景中添加 Shp 地标图

### 调用方法

```js
let jsonData = {  
  id: 'idObj',
  name: 'layerName',
  coordZ: 150,
  coordZFiled: 'heightField',
  autoScale: false,
  visible: true,
  idField: 'idField',
  labelField: 'poititleField',
  legendsField: 'legendField',
  shpEncoding: 'utf8',
  shpPath: 'http://tuguan.net/test.shp',
  tags: ["tag1", "tag2", "tag3"],
  legends: [
    {
        name: 'legendName1',
        color: '#ff0000'，
        iconName: 'camera',
        iconScale: 1,
        labelScale: 1
    },
    {
        name: 'legendName2',
        color: '#ff0000'，
        iconName: 'camera',
        iconScale: 1,
        labelScale: 1
    }
  ]
};

appInstance.uniCall('addLandmarkLayerShp', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性                  | 类型    | 说明                                                                                                                                                  | 端渲染 | 流渲染 |
| --------------------- | ------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- | ------ | ------ |
| id                    | String  | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                                                   | 支持   | 支持   |
| name                  | String  | 图层名称，支持为图层自定义名称                                                                                                                        | 支持   | 支持   |
| coordZ                | Number  | 高度（单位：米）                                                                                                                                      | 支持   | 支持   |
| coordZFiled           | String  | 高度在 SHP 文件中属性表的字段名称，如果有这个字段则 coordZ 不起作用（单位：米）                                                                       | 支持   | 支持   |
| autoScale             | Boolean | 默认 false, 如果开启 true 后，图标会按照摄像机远近自动缩放大小                                                                                        | 支持   | 支持   |
| visible               | Boolean | 添加当前图层时默认显示还是隐藏                                                                                                                        | 支持   | 支持   |
| idField               | String  | 对象唯一标识在 SHP 文件中属性表的字段名称                                                                                                             | 支持   | 支持   |
| labelField            | String  | 标签文字在 SHP 文件中属性表的字段名称，如果不写或为空就只显示图标                                                                                     | 支持   | 支持   |
| legendsField          | String  | 对象图例字段在 SHP 文件中属性表的字段名称                                                                                                             | 支持   | 支持   |
| shpEncoding           | String  | shp 文件的编码格式，可以是"utf8"或者"gb2312"                                                                                                          | 支持   | 支持   |
| shpPath               | String  | 在线地址：shp 文件 URL ; 本地地址一："file:///D:/xxx/shpData.shp"；D: 云渲染所在盘符 ; 本地地址二："path:/UserData/shpData.shp"，资源由云渲染后台管理 | 支持   | 支持   |
| tags                  | Array   | 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐                                                                                            | 不支持 | 支持   |
| legends[0].name       | String  | 图层内图例名称，新建时调用者自己传入的唯一名称，用于各种操作的图例识别                                                                                | 支持   | 支持   |
| legends[0].color      | String  | 颜色（HEX 颜色值）                                                                                                                                    | 支持   | 支持   |
| legends[0].iconName   | String  | 内置图标名称                                                                                                                                          | 支持   | 支持   |
| legends[0].iconScale  | Number  | 默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                                                                        | 支持   | 支持   |
| legends[0].labelScale | Number  | 默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                                                                        | 支持   | 支持   |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)
