# 三维柱图操作

## 目录

- [1.添加三维柱图](#1添加三维柱图)
- [2.更新三维柱图数据](#2更新三维柱图数据)
- [3.更新三维柱图样式](#3更新三维柱图样式)
- [4.删除三维柱图](#4删除三维柱图)

## 1.添加三维柱图

### 功能描述

在三维场景中添加三维柱图

### 调用方法

```js
let jsonData = {
  id: 'bar',
  name: '三维柱状图',
  coordType: 0,
  coordTypeZ: 0,
  coordZ: 64,
  columnType: 'cube',
  columnMinHeight: 10,
  columnMaxHeight: 300,
  columnAlpha: 1,
  columnPaint: 'solid',
  columnGap: 0,
  columnWidth: 30,
  colorMax: '#FF2626',
  colorMin: '#FFFF00',
  valueMax: 250,
  valueMin: 10,
  labelColor: '#ffffff',
  labelBackgroundColor: '#333333',
  visible: true,
  pointDataId: 'pointDataId',
  tags: ['tag1', 'tag2', 'tag3'],
  legends: [
    {
      name: 'legendName1',
      minValue: 0,
      maxValue: 100,
      color: '#ff0000',
    },
    {
      name: 'legendName2',
      minValue: 100,
      maxValue: 200,
      color: '#00ff00',
    },
    {
      name: 'legendName3',
      minValue: 200,
      maxValue: 300,
      color: '#0000ff',
    },
  ],
  data: [
    {
      id: '1',
      coord: [113.93469300891401, 22.5203773863743],
      value: 10,
      label: '标题',
    },
    {
      id: '2',
      coord: [113.93469300891401, 22.5207773863743],
      value: 34,
      label: '标题',
    },
    {
      id: '3',
      coord: [113.93469300891401, 22.5211773863743],
      value: 10,
      label: '标题',
    },
  ],
};

appInstance.uniCall('add3DColumnLayer', jsonData, (result) => {
  console.result(result);
});
```

#### 参数描述

| 属性                 | 类型    | 说明                                                                                                                  | 端渲染 | 流渲染 |
| -------------------- | ------- | --------------------------------------------------------------------------------------------------------------------- | ------ | ------ |
| id                   | String  | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                   | 支持   | 支持   |
| name                 | String  | 图层名称，支持为图层自定义名称                                                                                        | 支持   | 支持   |
| coordType            | Number  | xy 轴坐标模式 坐标类型(0:x 经度 y 纬度；1:x 米 y 米，相对世界 00 点) 目前该属性仅支持属性值为 0                       | 支持   | 支持   |
| coordTypeZ           | Number  | Z 轴坐标类别，0：相对 3D 世界 0 海拔；1：相对 3D 世界地表；2：相对 3D 模型表面（单位：米） 目前该属性仅支持属性值为 0 | 支持   | 支持   |
| coordZ               | Number  | Z 轴高度(单位:米)                                                                                                     | 支持   | 支持   |
| columnType           | String  | 柱体外观类别，cube：方柱；cylinder：圆柱                                                                              | 支持   | 支持   |
| columnMinHeight      | Number  | 单体柱表达最小值的实际高度(单位:米)                                                                                   | 支持   | 支持   |
| columnMaxHeight      | Number  | 单体柱表达最大值的实际高度(单位:米)                                                                                   | 支持   | 支持   |
| columnAlpha          | Number  | 柱子透明度 0：完全透明；1：完全不透明                                                                                 | 支持   | 支持   |
| columnPaint          | String  | 柱体样式类别 solid：单色着色；linear：线性着色；legend 图例着色                                                       | 支持   | 支持   |
| columnGap            | Number  | 柱子间隙 (单位:米)（注意：此属性端渲染未生效）                                                                        | 支持   | 支持   |
| columnWidth          | Number  | 柱体宽度 (单位:米)                                                                                                    | 支持   | 支持   |
| colorMax             | String  | 最大值上限颜色（HEX 颜色值）                                                                                          | 支持   | 支持   |
| colorMin             | String  | 最小值下限颜色（HEX 颜色值）                                                                                          | 支持   | 支持   |
| valueMax             | Number  | 最大值上限                                                                                                            | 支持   | 支持   |
| valueMin             | Number  | 最小值下限                                                                                                            | 支持   | 支持   |
| labelColor           | String  | 标签文本颜色，可选值，默认白色                                                                                        | 支持   | 支持   |
| labelBackgroundColor | String  | 标签文本背景颜色，可选值，默认灰色                                                                                    | 支持   | 支持   |
| visible              | Boolean | 添加当前图层时默认显示还是隐藏                                                                                        | 支持   | 支持   |
| pointDataId          | String  | 对应本服务器上点数据对象，如果找到 pointDataId，则下方的 data 不起作用                                                | 支持   | 支持   |
| tags                 | Array   | 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐                                                            | 不支持 | 支持   |
| legends              | Array   | 定义图层包含图例，支持为不同图例定义各自样式，，只在 columnPaint 是 legend 的时候起作用                               | 支持   | 支持   |
| legends[0].name      | String  | 图层内图例名称，新建时调用者自己传入的唯一名称，用于各种操作的图例识别                                                | 支持   | 支持   |
| legends[0].minValue  | Number  | 数值最小值（不包括）                                                                                                  | 支持   | 支持   |
| legends[0].maxValue  | Number  | 数值最大值（包括）                                                                                                    | 支持   | 支持   |
| legends[0].color     | String  | 颜色（HEX 颜色值）                                                                                                    | 支持   | 支持   |
| data                 | Array   | 定义图层可视化数据                                                                                                    | 支持   | 支持   |
| data[0].id           | String  | 热力数据点的 id 名                                                                                                    | 支持   | 支持   |
| data[0].coord        | Number  | XY 轴坐标，X：经度；Y：纬度                                                                                           | 支持   | 支持   |
| data[0].label        | String  | 标签文本，如果为"",则不显示标签                                                                                       | 支持   | 支持   |
| data[0].value        | Number  | 数据点权值                                                                                                            | 支持   | 支持   |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 2.更新三维柱图数据

### 功能描述

更新三维场景中添加三维柱图的数据

### 调用方法

```js
let jsonData = {
  id: 'bar',
  name: '三维柱状图',
  coordType: 0,
  coordTypeZ: 0,
  coordZ: 64,
  isAppend: true,
  tags: ['tag1', 'tag2', 'tag3'],
  data: [
    {
      id: '5',
      coord: [113.934497516862, 22.5110736501728], //以深圳湾经纬度为例
      label: '标题',
      value: 87,
    },
    {
      id: '6',
      coord: [113.934679208037, 22.511925263600503],
      label: '标题',
      value: 45,
    },
    {
      id: '7',
      coord: [113.935858470429, 22.5127358773057],
      label: '标题',
      value: 73,
    },
    {
      id: '8',
      coord: [113.937764651685, 22.512384968131002],
      label: '标题',
      value: 46,
    },
  ],
};

appInstance.uniCall('update3DColumnLayerCoord', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性          | 类型    | 说明                                                                                                                          | 端渲染 | 流渲染 |
| ------------- | ------- | ----------------------------------------------------------------------------------------------------------------------------- | ------ | ------ |
| id            | String  | 图层 ID （唯一标识）                                                                                                          | 支持   | 支持   |
| name          | String  | 图层 name                                                                                                                     | 支持   | 支持   |
| coordType     | String  | xy 轴坐标模式 坐标类型(0:x 经度 y 纬度；1:x 米 y 米，相对世界 00 点) 目前该属性仅支持属性值为 0                               | 支持   | 支持   |
| coordTypeZ    | Number  | z 轴坐标模式 坐标高度类型，单位：米(0:相对 3D 世界 0 海拔；1:相对 3D 世界地表；2:相对 3D 模型表面) 目前该属性仅支持属性值为 0 | 支持   | 支持   |
| coordZ        | Number  | 高度(单位:米)                                                                                                                 | 支持   | 支持   |
| isAppend      | Boolean | true: 追加数据; false: 重建数据                                                                                               | 支持   | 支持   |
| tags          | Array   | 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐                                                                    | 不支持 | 支持   |
| data          | Array   | 数据点位基本信息集合                                                                                                          | 支持   | 支持   |
| data[0].id    | String  | 柱图当前柱 ID                                                                                                                 | 支持   | 支持   |
| data[0].coord | Array   | XY 轴坐标，X：经度；Y：纬度                                                                                                   | 支持   | 支持   |
| data[0].label | String  | 标签文本，如果为"",则不显示标签                                                                                               | 支持   | 支持   |
| data[0].value | Number  | 数据点权值                                                                                                                    | 支持   | 支持   |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 3.更新三维柱图样式

### 功能描述

更新三维场景中添加三维柱图的样式

### 调用方法

```js
let jsonData = {
  id: 'bar',
  columnType: 'cylinder',
  columnMinHeight: 30,
  columnMaxHeight: 300,
  columnAlpha: 0.8,
  columnPaint: 'solid',
  columnGap: 0,
  columnWidth: 30,
  colorMax: '#26C9FF',
  colorMin: '#FF00FF',
  valueMax: 200,
  valueMin: 10,
  labelColor: '#ffffff',
  labelBackgroundColor: '#333333',
};
appInstance.uniCall('update3DColumnLayerStyle', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性                 | 类型   | 说明                                                                |
| -------------------- | ------ | ------------------------------------------------------------------- |
| id                   | String | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别 |
| columnType           | String | 柱状热力图柱体外观类型; cube 方柱,cylinder 圆柱                     |
| columnMinHeight      | Number | 单体柱表达最小值的实际高度(单位:米)                                 |
| columnMaxHeight      | Number | 单体柱表达最大值的实际高度(单位:米)                                 |
| columnAlpha          | Number | 柱体透明度，0：完全透明；1：完全不透明                              |
| columnPaint          | String | 柱体样式类别，solid：单色着色；linear：线性着色                     |
| columnGap            | Number | 柱子间隙（单位:米）（注意：此属性端渲染未生效）                     |
| columnWidth          | Number | 柱体宽度（单位：米）                                                |
| colorMax             | String | 最大值上限颜色（HEX 颜色值）                                        |
| colorMin             | String | 最小值下限颜色（HEX 颜色值）                                        |
| valueMax             | Number | 最大值上限                                                          |
| valueMin             | Number | 最小值下限                                                          |
| labelColor           | String | 标签文本颜色，可选值，默认白色                                      |
| labelBackgroundColor | String | 标签文本背景颜色，可选值，默认灰色                                  |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 4.删除三维柱图

### 功能描述

删除三维柱图

### 调用方法

```js
let jsonData = {
  id: 'bar',
  overlayType: '3DColumnLayer',
};

appInstance.uniCall('removeOverlay', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型   | 说明                                                                |
| ----------- | ------ | ------------------------------------------------------------------- |
| id          | String | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别 |
| overlayType | String | 图层对象类别                                                        |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

### 流渲染效果图

<img src="./contents/mediaFiles/images/3DColumnLayer/3DColumnLayer-Streaming.jpg" width = "544" height="405" alt="系统架构图" />

### 端渲染效果图

<img src="./contents/mediaFiles/images/3DColumnLayer/3DColumnLayer.jpg" width = "544" height="405" alt="系统架构图" />

[返回本章目录](#目录)
