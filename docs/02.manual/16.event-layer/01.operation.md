# 事件图操作

## 目录

- [1.添加事件图](#1添加事件图)
- [2.更新事件图数据](#2更新事件图数据)
- [3.更新事件图样式](#3更新事件图样式)
- [4.删除事件图](#4删除事件图)

## 1.添加事件图

### 功能描述

在三维场景中添加事件图

### 调用方法

```js
let jsonData = {
  id: 'eventLayerId', // 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别
  name: 'layerName', // 图层名称，支持为图层自定义名称
  coordType: 0, // XY 轴坐标类别，0：X 经度，Y 纬度；1：X 米，Y米，相对世界00点
  coordTypeZ: 0, // Z 轴坐标类别，0：相对 3D 世界 0 海拔；1：相对 3D 世界地表；2：相对 3D 模型表面（单位：米）
  visible: true, // 添加当前图层时默认是显示还是隐藏
  tags: ['tag1', 'tag2', 'tag3'], // 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐
  legends: [
    // 定义图层包含图例，支持为不同图例定义各自样式
    {
      name: '摄像头', // 图层内图例名称，新建时调用者自己传入的唯一名称，用于各种操作的图例识别
      icon: 'camera', // 内置图标名称，或根据项目，在场景中预置好的图标对象的名称，包含文字样式定义，具体图标名称参考下表和下图
      iconScale: 1,
      labelScale: 1,
      color: '#ff0000', // 颜色（HEX 颜色值）
      speed: 50, // 气泡扩散速度（单位：米/秒）
      radius: 100, // 气泡最大半径（单位：米）
    },
    {
      name: '汽车', // 图层内图例名称，新建时调用者自己传入的唯一名称，用于各种操作的图例识别
      icon: 'car', // 内置图标名称，或根据项目，在场景中预置好的图标对象的名称，包含文字样式定义，具体图标名称参考下表和下图
      iconScale: 1,
      labelScale: 1,
      color: '#ff0000', // 颜色（HEX 颜色值）
      speed: 50, // 气泡扩散速度（单位：米/秒）
      radius: 100, // 气泡最大半径（单位：米）
    },
  ],
  data: [
    // 定义图层可视化数据
    {
      id: '事件01', // 图层子对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别
      coord: [113.93629142691101, 22.5222703163178], // XY 轴坐标，X：经度；Y：纬度
      coordZ: 64, // Z 轴高度（单位：米）
      message: '摄像头损坏', // 数据点事件信息
      type: '摄像头', // 数据点图例类别
    },
    {
      id: '事件02', // 图层子对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别
      coord: [113.93829142691101, 22.521270316317803], // XY 轴坐标，X：经度；Y：纬度
      coordZ: 64, // Z 轴高度（单位：米）
      message: '汽车损坏', // 数据点事件信息
      type: '汽车', // 数据点图例类别
    },
  ],
};
appInstance.uniCall('addEventLayer', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性                  | 类型    | 说明                                                                                                   | 端渲染 | 流渲染 |
| --------------------- | ------- | ------------------------------------------------------------------------------------------------------ | ------ | ------ |
| id                    | String  | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                    | 支持   | 支持   |
| name                  | String  | 图层名称，支持为图层自定义名称                                                                         | 支持   | 支持   |
| coordType             | Number  | XY 轴坐标类别，0：X 经度，Y 纬度；1：X 米，Y 米，相对世界 00 点                                        | 支持   | 支持   |
| coordTypeZ            | Number  | Z 轴坐标类别，0：相对 3D 世界 0 海拔；1：相对 3D 世界地表；2：相对 3D 模型表面（单位：米）             | 支持   | 支持   |
| visible               | Boolean | 添加当前图层时默认显示还是隐藏                                                                         | 支持   | 支持   |
| tags                  | Array   | 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐                                             | 不支持 | 支持   |
| legends               | Array   | 定义图层包含图例，支持为不同图例定义各自样式                                                           | 支持   | 支持   |
| legends[0].name       | String  | 图层内图例名称，新建时调用者自己传入的唯一名称，用于各种操作的图例识别                                 | 支持   | 支持   |
| legends[0].icon       | String  | 内置图标名称，或根据项目，在场景中预置好的图标对象的名称，包含文字样式定义，具体图标名称参考下表和下图 | 支持   | 支持   |
| legends[0].iconScale  | Number  | 默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                         | 支持   | 支持   |
| legends[0].labelScale | Number  | 默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                         | 支持   | 支持   |
| legends[0].color      | String  | 颜色（HEX 颜色值）                                                                                     | 支持   | 支持   |
| legends[0].speed      | Number  | 气泡扩散速度（单位：米/秒）                                                                            | 支持   | 支持   |
| legends[0].radius     | Number  | 气泡最大半径（单位：米）                                                                               | 支持   | 支持   |
| data                  | Array   | 定义图层可视化数据                                                                                     | 支持   | 支持   |
| data[0].id            | String  | 图层子对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                  | 支持   | 支持   |
| data[0].coord         | Array   | XY 轴坐标，X：经度；Y：纬度                                                                            | 支持   | 支持   |
| data[0].coordZ        | Number  | Z 轴高度（单位：米）                                                                                   | 支持   | 支持   |
| data[0].message       | String  | 数据点事件信息                                                                                         | 支持   | 支持   |
| data[0].type          | String  | 数据点图例类别                                                                                         | 支持   | 支持   |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

### 具体内置图标名称（iconName）详情

<table>
    <tr>
      <th>图标类型</th>
      <th>图标名称</th>
    </tr>
    <tr>
      <td rowspan="15" style="text-align:left;">市政设施</td>
      <td>camera</td>
    </tr>
    <tr>
      <td>streetlamp</td>
    </tr>
    <tr>
      <td>manholecover</td>
    </tr>
    <tr>
      <td>sensor</td>
    </tr>
    <tr>
      <td>utilitypole</td>
    </tr>
    <tr>
      <td>transmission</td>
    </tr>
    <tr>
      <td>broadcast</td>
    </tr>
    <tr>
      <td>wifi</td>
    </tr>
    <tr>
      <td>firehydrant</td>
    </tr>
    <tr>
      <td>equipmentbox</td>
    </tr>
    <tr>
      <td>trafficlight</td>
    </tr>
    <tr>
      <td>charge</td>
    </tr>
    <tr>
      <td>gasstation</td>
    </tr>
    <tr>
      <td>wc</td>
    </tr>
    <tr>
      <td>dustbin</td>
    </tr>
    <tr>
      <td rowspan="20" style="text-align:left;">地点建筑</td>
      <td>trainstation</td>
    </tr>
    <tr>
      <td>airport</td>
    </tr>
    <tr>
      <td>anchor</td>
    </tr>
    <tr>
      <td>government</td>
    </tr>
    <tr>
      <td>netpoint</td>
    </tr>
    <tr>
      <td>metro</td>
    </tr>
    <tr>
      <td>finance</td>
    </tr>
    <tr>
      <td>school</td>
    </tr>
    <tr>
      <td>hospital</td>
    </tr>
    <tr>
      <td>factory</td>
    </tr>
    <tr>
      <td>constructionsite</td>
    </tr>
    <tr>
      <td>residence</td>
    </tr>
    <tr>
      <td>mergencyshelter</td>
    </tr>
    <tr>
      <td>park</td>
    </tr>
    <tr>
      <td>diningroom</td>
    </tr>
    <tr>
      <td>warehouse</td>
    </tr>
    <tr>
      <td>store</td>
    </tr>
    <tr>
      <td>tollgate</td>
    </tr>
    <tr>
      <td>officebuilding</td>
    </tr>
    <tr>
      <td>busstation</td>
    </tr>
    <tr>
      <td rowspan="5" style="text-align:left;">人员</td>
      <td>people</td>
    </tr>
    <tr>
      <td>policeman</td>
    </tr>
    <tr>
      <td>doctor</td>
    </tr>
    <tr>
      <td>specialpeople</td>
    </tr>
    <tr>
      <td>criminal</td>
    </tr>
    <tr>
      <td rowspan="15" style="text-align:left;">交通</td>
      <td>car</td>
    </tr>
    <tr>
      <td>policecar</td>
    </tr>
    <tr>
      <td>fireengine</td>
    </tr>
    <tr>
      <td>ambulance</td>
    </tr>
    <tr>
      <td>taxi</td>
    </tr>
    <tr>
      <td>truck</td>
    </tr>
    <tr>
      <td>bus</td>
    </tr>
    <tr>
      <td>newscar</td>
    </tr>
    <tr>
      <td>militarycar</td>
    </tr>
    <tr>
      <td>municipal</td>
    </tr>
    <tr>
      <td>electriccar</td>
    </tr>
    <tr>
      <td>watercar</td>
    </tr>
    <tr>
      <td>train</td>
    </tr>
    <tr>
      <td>ship</td>
    </tr>
    <tr>
      <td>cargoship</td>
    </tr>
    <tr>
      <td rowspan="5" style="text-align:left;">飞行器</td>
      <td>airplane</td>
    </tr>
    <tr>
      <td>helicopter</td>
    </tr>
    <tr>
      <td>uav</td>
    </tr>
    <tr>
      <td>satellite</td>
    </tr>
    <tr>
      <td>rocket</td>
    </tr>
    <tr>
      <td rowspan="3" style="text-align:left;">事件</td>
      <td>event_01</td>
    </tr>
    <tr>
      <td>event_03</td>
    </tr>
    <tr>
      <td>event_03</td>
    </tr>
    <tr>
      <td rowspan="4" style="text-align:left;">通用</td>
      <td>icon_01</td>
    </tr>
    <tr>
      <td>icon_02</td>
    </tr>
    <tr>
      <td>icon_03</td>
    </tr>
    <tr>
      <td>icon_04</td>
    </tr>
    <tr>
      <td rowspan="3" style="text-align:left;">地名</td>
      <td>site_01</td>
    </tr>
    <tr>
      <td>site_02</td>
    </tr>
    <tr>
      <td>site_03</td>
    </tr>
</table>

### 具体内置图标名称（iconName）效果

<img src="./contents/mediaFiles/images/iconName.jpg" width = "1344" height = "765" alt="图标效果" />

## 2.更新事件图数据

### 功能描述

更新三维场景中添加事件图的数据

### 调用方法

```js
let jsonData = {
  id: 'eventLayerId', // 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别
  name: 'layerName', // 图层名称，支持为图层自定义名称
  coordType: 0, // XY 轴坐标类别，0：X 经度，Y 纬度；1：X 米，Y米，相对世界00点
  coordTypeZ: 0, // Z 轴坐标类别，0：相对 3D 世界 0 海拔；1：相对 3D 世界地表；2：相对 3D 模型表面（单位：米）
  isAppend: true, // 是否追加数据（按数据顺序），true：按新数据 更新原有重复数据 & 追加新数据；false：清除原有数据 & 重建新数据
  tags: ['tag1', 'tag2', 'tag3'], // 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐
  data: [
    // 定义图层可视化数据
    {
      id: '事件01', // 图层子对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别
      coord: [113.93629142691101, 22.5222703163178], // XY 轴坐标，X：经度；Y：纬度
      coordZ: 64, // Z 轴高度（单位：米）
      message: '摄像头损坏', // 数据点事件信息
      type: '汽车', // 数据点图例类别
    },
    {
      id: '事件02', // 图层子对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别
      coord: [113.93829142691101, 22.521270316317803], // XY 轴坐标，X：经度；Y：纬度
      coordZ: 64, // Z 轴高度（单位：米）
      message: '汽车损坏', // 数据点事件信息
      type: '摄像头', // 数据点图例类别
    },
    {
      id: '事件03', // 图层子对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别
      coord: [113.94142608825801, 22.514970821783603], // XY 轴坐标，X：经度；Y：纬度
      coordZ: 500, // Z 轴高度（单位：米）
      message: '汽车又损坏', // 数据点事件信息
      type: '汽车', // 数据点图例类别
    },
  ],
};

appInstance.uniCall('updateEventLayerCoord', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性            | 类型    | 说明                                                                                       | 端渲染 | 流渲染 |
| --------------- | ------- | ------------------------------------------------------------------------------------------ | ------ | ------ |
| id              | String  | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                        | 支持   | 支持   |
| name            | String  | 图层名称，支持为图层自定义名称                                                             | 支持   | 支持   |
| coordType       | Number  | XY 轴坐标类别，0：X 经度，Y 纬度；1：X 米，Y 米，相对世界 00 点                            | 支持   | 支持   |
| coordTypeZ      | Number  | Z 轴坐标类别，0：相对 3D 世界 0 海拔；1：相对 3D 世界地表；2：相对 3D 模型表面（单位：米） | 支持   | 支持   |
| isAppend        | Boolean | 是否追加数据（按数据顺序），true：在原有数据后方追加数据；false：清除原有数据，更新数据    | 支持   | 支持   |
| tags            | Array   | 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐                                 | 不支持 | 支持   |
| data            | Array   | 定义图层可视化数据                                                                         | 支持   | 支持   |
| data[0].id      | String  | 图层子对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                      | 支持   | 支持   |
| data[0].coord   | Array   | XY 轴坐标，X：经度；Y：纬度                                                                | 支持   | 支持   |
| data[0].coordZ  | Number  | Z 轴高度（单位：米）                                                                       | 支持   | 支持   |
| data[0].message | String  | 数据点事件信息                                                                             | 支持   | 支持   |
| data[0].type    | String  | 数据点图例类别                                                                             | 支持   | 支持   |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 3.更新事件图样式

### 功能描述

更新三维场景中添加事件图的样式

### 调用方法

```js
let jsonData = {
  id: 'eventLayerId', // 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别
  legends: [
    // 定义图层包含图例，支持为不同图例定义各自样式
    {
      name: '摄像头', // 图层内图例名称，新建时调用者自己传入的唯一名称，用于各种操作的图例识别
      icon: 'anchor', // 内置图标名称，或根据项目，在场景中预置好的图标对象的名称，包含文字样式定义，具体图标名称参考上表和上图
      color: '#00ff00', // 颜色（HEX 颜色值）
      iconScale: 1,
      labelScale: 1,
      speed: 50, // 气泡扩散速度（单位：米/秒）
      radius: 100, // 气泡最大半径（单位：米）
    },
    {
      name: '汽车', // 图层内图例名称，新建时调用者自己传入的唯一名称，用于各种操作的图例识别
      icon: 'busstation', // 内置图标名称，或根据项目，在场景中预置好的图标对象的名称，包含文字样式定义，具体图标名称参考上表和上图
      color: '#00ffff', // 颜色（HEX 颜色值）
      iconScale: 1,
      labelScale: 1,
      speed: 50, // 气泡扩散速度（单位：米/秒）
      radius: 100, // 气泡最大半径（单位：米）
    },
  ],
};

appInstance.uniCall('updateEventLayerStyle', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性                  | 类型   | 说明                                                                                                   |
| --------------------- | ------ | ------------------------------------------------------------------------------------------------------ |
| id                    | String | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                    |
| legends               | Array  | 定义图层包含图例，支持为不同图例定义各自样式                                                           |
| legends[0].name       | String | 图层内图例名称，新建时调用者自己传入的唯一名称，用于各种操作的图例识别                                 |
| legends[0].icon       | String | 内置图标名称，或根据项目，在场景中预置好的图标对象的名称，包含文字样式定义，具体图标名称参考下表和下图 |
| legends[0].color      | String | 颜色（HEX 颜色值）                                                                                     |
| legends[0].iconScale  | Number | 默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                         |
| legends[0].labelScale | Number | 默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                         |
| legends[0].speed      | Number | 气泡扩散速度（单位：米/秒）                                                                            |
| legends[0].radius     | Number | 气泡最大半径（单位：米）                                                                               |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 4.删除事件图

### 功能描述

删除事件图

### 调用方法

```js
let jsonData = {
  id: 'eventLayerId', // 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别
  overlayType: 'eventLayer', // 图层对象类别
};

appInstance.uniCall('removeOverlay', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型   | 说明                                                                |
| ----------- | ------ | ------------------------------------------------------------------- |
| id          | String | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别 |
| overlayType | String | 图层对象类别                                                        |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

<!-- ### 流渲染效果图：
<img src="./contents/mediaFiles/images/overlay/eventLayer-streaming.png" width = "544" height="405" alt="系统架构图" /> -->

### 端渲染效果图

<img src="./contents/mediaFiles/images/overlay/eventLayer.png" width = "544" height="405" alt="系统架构图" />

[返回本章目录](#目录)
