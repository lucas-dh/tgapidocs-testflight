# 图层控制操作

## 目录

- [1.设置图层对象显隐](#1设置图层对象显隐)
- [2.设置类别图层显隐](#2设置类别图层显隐)
- [3.设置标签图层显隐](#3设置标签图层显隐-流)
- [4.设置图层子对象显隐](#4设置图层子对象显隐)
- [5.删除图层对象](#5删除图层对象)
- [6.删除图层子对象](#6删除图层子对象)
- [7.删除类别图层](#7删除类别图层)
- [8.移除图层尾迹](#8移除图层尾迹-流)
- [9.获取图层顺序](#9获取图层顺序)
- [10.前移图层](#10前移图层)
- [11.后移图层](#11后移图层)
- [12.添加图层对象 Tip](#12添加图层对象Tip)
- [13.移除图层对象 Tip](#13移除图层对象Tip)
- [14.获取类别图层](#14获取类别图层)
- [15.获取图层子图层对象](#15获取图层子图层对象)

## 1.设置图层对象显隐

### 功能描述

设置图层对象显隐

### 调用方法

```js
let jsonData = {
  id: 'landmark',
  overlayType: 'landmark',
  visible: false,
};

appInstance.uniCall('setOverlayVisibility', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型    | 说明                                                                |
| ----------- | ------- | ------------------------------------------------------------------- |
| id          | String  | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别 |
| overlayType | String  | 图层对象类别，参考下面图层对象类别枚举表格                          |
| visible     | Boolean | 显隐控制，true：显示；false：隐藏                                   |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                                        |
| ------- | ------ | ------------------------------------------- |
| result  | Number | result 为执行结果，1 代表成功，0 代表失败。 |
| message | String | 为成功或失败消息                            |

### 图层对象类别枚举

| 值                    | 类型   | 备注            |
| --------------------- | ------ | --------------- |
| landmark              | String | 地标点          |
| path                  | String | 路径            |
| area                  | String | 区域轮廓        |
| circularArea          | String | 圆形轮廓        |
| 3DTile                | String | 3DTile 倾斜摄影 |
| gisMap                | String | TMS 瓦片        |
| landmarkLayer         | String | 地标图          |
| 3DColumnLayer         | String | 三维柱状图      |
| 3DGridLayer           | String | 栅格图          |
| heatMapLayer          | String | 热力图          |
| starLightLayer        | String | 星光图          |
| bubbleLayer           | String | 气泡图          |
| eventLayer            | String | 事件图          |
| trailLayer            | String | 轨迹图          |
| trackLayer            | String | 点迹图          |
| ODLineLayer           | String | 关系图          |
| typeAreaLayer         | String | 类型区域图      |
| colorAreaLayer        | String | 数值区域图      |
| roadPtHeatLayer       | String | 路径点热力图    |
| roadSgHeatLayer       | String | 路径段热力图    |
| 3DMarker              | String | 特效对象        |
| modelTrailLayer       | String | 模型轨迹图      |
| modelLandmarkLayer    | String | 模型地标图      |
| 3DMarkerLandmarkLayer | String | 特效地标图      |
| aggLandmarkLayer      | String | 聚簇地标图      |
| aggBubbleLayer        | String | 聚簇气泡图      |
| aggEventBublleLayer   | String | 聚簇事件图      |
| aggHeatMapLayer       | String | 聚簇热力图      |
| agg3DColumnLayer      | String | 聚簇三维柱状图  |
| agg3DGridLayer        | String | 聚簇栅格图      |
| subLandmarkLayer      | String | 抽稀地标图      |

[返回本章目录](#目录)

## 2.设置类别图层显隐

### 功能描述

设置类别图层显隐

### 调用方法

```js
let jsonData = {
  overlayType: 'landmark',
  visible: true,
};

appInstance.uniCall('setOverlayTypeVisibility', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型    | 说明                                        |
| ----------- | ------- | ------------------------------------------- |
| overlayType | String  | 图层对象类别 ，参考上面图层对象类别枚举表格 |
| visible     | Boolean | 显隐控制，true：显示；false：隐藏           |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 3.设置标签图层显隐 <span style="width: 40px;height: 21px;display:inline-block;background: #0fcccc;margin-left: 5px;line-height: 19px;"><span style="width: 100%;height: 100%;background: url(./img/stream.png) no-repeat 4px 5px;background-size: 12px 10px;text-indent: 22px;font-size: 12px;color: #ffffff;line-height: 20px;display:inline-block;vertical-align: top;">流</span></span>

### 功能描述

设置标签图层显隐

### 调用方法

```js
let jsonData = {
  tags: ['tags1', 'tags2', 'tags3'],
  visible: true,
};

appInstance.uniCall('setOverlayTagsVisibility', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性    | 类型    | 说明                                                       |
| ------- | ------- | ---------------------------------------------------------- |
| tags    | Array   | 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐 |
| visible | Boolean | 显隐控制，true：显示；false：隐藏                          |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 4.设置图层子对象显隐

### 功能描述

设置图层子对象显隐

### 调用方法

```js
let jsonData = {
  idLayer: 'layerId',
  overlayType: 'landmarkLayer',
  id: 'objId',
  ids: [],
  visible: true,
};

appInstance.uniCall('setOverlayObjVisibility', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型    | 说明                                                                                                                                                                                                                                                                                                                                                                                                      |
| ----------- | ------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| idLayer     | String  | 图层对象 id，只支持带有子对象的图层                                                                                                                                                                                                                                                                                                                                                                       |
| overlayType | String  | 图层对象类别，只支持带有子对象的图层，包括：landmarkLayer，bubbleLayer，eventLayer，trailLayer，trackLayer，typeAreaLayer，colorAreaLayer，roadSgHeatLayer，3DColumnLayer，3DGridLayer，modelTrailLayer，modelLandmarkLayer，3DMarkerLandmarkLayer，iconModelTrailLayer，iconModelLandmarkLayer，aggLandmarkLayer，aggBubbleLayer，aggEventBublleLayer，aggHeatMapLayer，agg3DColumnLayer，agg3DGridLayer |
| id          | String  | 需要控制显隐的图层子对象 id                                                                                                                                                                                                                                                                                                                                                                               |
| ids         | Array   | 需要控制显隐的图层子对象 id 数组，如果这个不为空，则会和 id 选中一起作用                                                                                                                                                                                                                                                                                                                                  |
| visible     | Boolean | 显隐控制，true：显示；false：隐藏                                                                                                                                                                                                                                                                                                                                                                         |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 5.删除图层对象

### 功能描述

删除图层对象

### 调用方法

```js
let jsonData = {
  id: 'landmark',
  overlayType: 'landmark',
};

appInstance.uniCall('removeOverlay', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型   | 说明                                                                |
| ----------- | ------ | ------------------------------------------------------------------- |
| id          | String | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别 |
| overlayType | String | 图层对象类别，参考上面图层对象类别枚举表格                          |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 6.删除图层子对象

### 功能描述

删除图层子对象

### 调用方法

```js
let jsonData = {
  overlayType: 'landmarkLayer',
  idLayer: 'layerId',
  id: '1',
  ids: [],
};

appInstance.uniCall('removeLayerObj', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型   | 说明                                                                                                                                                                                                                                                                                                                                                                                                      |
| ----------- | ------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| overlayType | String | 图层对象类别，只支持带有子对象的图层，包括：landmarkLayer，bubbleLayer，eventLayer，trailLayer，trackLayer，typeAreaLayer，colorAreaLayer，roadSgHeatLayer，3DColumnLayer，3DGridLayer，modelTrailLayer，modelLandmarkLayer，3DMarkerLandmarkLayer，iconModelTrailLayer，iconModelLandmarkLayer，aggLandmarkLayer，aggBubbleLayer，aggEventBublleLayer，aggHeatMapLayer，agg3DColumnLayer，agg3DGridLayer |
| idLayer     | String | 图层对象 id，只支持带有子对象的图层                                                                                                                                                                                                                                                                                                                                                                       |
| id          | String | 需要删除的图层子对象 id                                                                                                                                                                                                                                                                                                                                                                                   |
| ids         | Array  | 需要删除的图层子对象 id 数组，如果这个不为空，则会和 id 一起被删除                                                                                                                                                                                                                                                                                                                                        |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 7.删除类别图层

### 功能描述

删除类别图层

### 调用方法

```js
let jsonData = {
  overlayType: 'landmark',
};

appInstance.uniCall('clearOverlayType', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型   | 说明                                               |
| ----------- | ------ | -------------------------------------------------- |
| overlayType | String | 覆盖物类型,支持 all ，参考上面图层对象类别枚举表格 |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 8.移除图层尾迹 <span style="width: 40px;height: 21px;display:inline-block;background: #0fcccc;margin-left: 5px;line-height: 19px;"><span style="width: 100%;height: 100%;background: url(./img/stream.png) no-repeat 4px 5px;background-size: 12px 10px;text-indent: 22px;font-size: 12px;color: #ffffff;line-height: 20px;display:inline-block;vertical-align: top;">流</span></span>

### 功能描述

移除图层尾迹

### 调用方法

```js
let jsonData = {
  overlayType: 'modelTrailLayer',
  idLayer: 'layerId',
  id: 'objId',
};

appInstance.uniCall('clearOverlayTrail', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型   | 说明                                                              |
| ----------- | ------ | ----------------------------------------------------------------- |
| overlayType | String | 图层类型，支持 trailLayer、modelTrailLayer 和 iconModelTrailLayer |
| idLayer     | String | 图层 Id，可为空，为空表示清空该类型所有尾迹                       |
| id          | String | 对象 Id，可为空，为空时表示清空该图层所有对象尾迹                 |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 9.获取图层顺序

### 功能描述

获取图层顺序

### 调用方法

```js
appInstance.uniCall('getOverlaysOrder', {}, (result) => {
  console.log(result);
});
```

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。",
  "data": [
    {
      "idLayer": "layerId1",
      "index": 1
    },
    {
      "idLayer": "layerId2",
      "index": 2
    }
  ]
}
```

#### 回调数据参数描述

| 属性            | 类型   | 说明                                                                                            |
| --------------- | ------ | ----------------------------------------------------------------------------------------------- |
| result          | Number | 1：代表成功；0：代表失败                                                                        |
| message         | String | 成功或者失败原因                                                                                |
| data            | Array  | 获取图层数据                                                                                    |
| data[0].idLayer | String | 图层 Id                                                                                         |
| data[0].index   | Number | 图层 index，越大表示在在前面，会遮挡其他图层，最下面的图层 index 是 1，index 是连续的，没有间断 |

[返回本章目录](#目录)

## 10.前移图层

### 功能描述

前移图层

### 调用方法

```js
let jsonData = {
  idLayer: 'layerId', // 需要移动的图层Id
  offset: 1, // 移动图层偏移几个，是相对图层的数量，如果是0，表示前移到最上面，值域只能是大于0
};
appInstance.uniCall('moveOverlayForward', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性    | 类型   | 说明                                                                             |
| ------- | ------ | -------------------------------------------------------------------------------- |
| idLayer | String | 需要移动的图层 Id                                                                |
| offset  | String | 移动图层偏移几个，是相对图层的数量，如果是 0，表示前移到最上面，值域只能是大于 0 |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 11.后移图层

### 功能描述

后移图层

### 调用方法

```js
let jsonData = {
  idLayer: 'layerId', // 需要移动的图层Id
  offset: 1, // 移动图层偏移几个，是相对图层的数量，如果是0，表示前移到最上面，值域只能是大于0
};
appInstance.uniCall('moveOverlayBackward', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性    | 类型   | 说明                                                                             |
| ------- | ------ | -------------------------------------------------------------------------------- |
| idLayer | String | 需要移动的图层 Id                                                                |
| offset  | String | 移动图层偏移几个，是相对图层的数量，如果是 0，表示前移到最上面，值域只能是大于 0 |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 12.添加图层对象 Tip

### 功能描述

添加图层对象 Tip

### 调用方法

```js
let jsonData = {
  id: 'landmark',
  url: 'http://www.tuguan.net/testdlg.html',
  divId: 'tipDivId',
  size: [500, 300],
  offset: [100, -30],
  isShowClose: true,
  overlayType: 'landmark',
  canDrag: false,
  showLine: false,
  lineColor: '#ff0000',
  lineWidth: 1,
  lineStyle: 'solid',
};

appInstance.uniCall('addOverlayTip', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型    | 说明                                                                                    | 端渲染 | 流渲染 |
| ----------- | ------- | --------------------------------------------------------------------------------------- | ------ | ------ |
| id          | String  | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                     | 支持   | 支持   |
| url         | String  | Tip 窗口页面地址                                                                        | 支持   | 支持   |
| divId       | String  | HTML 侧弹出标牌的 dom div id，如果这个不为""，url 属性不起作用                          | 支持   | 支持   |
| isShowClose | Boolean | 是否显示右上角关闭按钮，默认显示关闭按钮                                                | 支持   | 支持   |
| size        | Array   | Tip 窗口宽高 xy，x：窗口宽；y：窗口高（单位：像素）                                     | 支持   | 支持   |
| offset      | Array   | Tip 左上角相对 对象中心点 偏移量 xy，x：为正，向右偏移；y：为正，向上偏移（单位：像素） | 支持   | 支持   |
| overlayType | String  | 图层对象类别，参考上面图层对象类别枚举表格                                              | 支持   | 支持   |
| canDrag     | Boolean | 是否可以拖拽标牌，默认 false，true: 可以拖拽，false: 不可以拖拽                         | 支持   | 不支持 |
| showLine    | Boolean | 是否显示标牌到中心点的连线，默认 false，true: 显示，false: 不显示                       | 支持   | 不支持 |
| lineColor   | String  | 标牌连线颜色                                                                            | 支持   | 不支持 |
| lineWidth   | Number  | 标牌连线宽度                                                                            | 支持   | 不支持 |
| lineStyle   | String  | 标牌连线样式，"solid": 实线，"dashed": 虚线，"dotted"：点线                             | 支持   | 不支持 |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 13.移除图层对象 Tip

### 功能描述

移除图层对象 Tip

### 调用方法

```js
let jsonData = {
  id: "landmark"
  overlayType: "landmark"
};

appInstance.uniCall('removeOverlayTip', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型   | 说明                                                                                              |
| ----------- | ------ | ------------------------------------------------------------------------------------------------- |
| id          | String | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别，如果 id 为空，则删除所有 TIP |
| overlayType | String | 图层对象类别 ，参考上面图层对象类别枚举表格                                                       |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 14.获取类别图层

### 功能描述

获取类别图层

### 调用方法

```js
let jsonData = {
  overlayType: 'landmark',
};

appInstance.uniCall('getOverlaysByType', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型   | 说明                                        |
| ----------- | ------ | ------------------------------------------- |
| overlayType | String | 图层对象类别 ，参考上面图层对象类别枚举表格 |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。",
  "type": "landmark",
  "data": [
    {
      "id": "objId1",
      "name": "objName1"
    },
    {
      "id": "objId2",
      "name": "objName2"
    }
  ]
}
```

#### 回调数据参数描述

| 属性         | 类型   | 说明                                    |
| ------------ | ------ | --------------------------------------- |
| result       | Number | 1：代表成功；0：代表失败                |
| message      | String | 成功或者失败原因                        |
| type         | String | 图层类型                                |
| data         | Array  | 获取图层数据                            |
| data[0].id   | String | 图层 id                                 |
| data[0].name | String | layer 类别覆盖物，会返回 name，其他为空 |

[返回本章目录](#目录)

## 15.获取图层子图层对象

### 功能描述

获取图层子图层对象

### 调用方法

```js
let jsonData = {
  idLayer: 'layerId',
  layerType: 'landmarkLayer',
};

appInstance.uniCall('getOverlaysByLayer', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性      | 类型   | 说明                                                    |
| --------- | ------ | ------------------------------------------------------- |
| idLayer   | String | 含子图层对象的图层 id，会获取该图层的所有子对象         |
| layerType | String | 含子图层对象的图层类别 参考下表含子图层对象图层类别枚举 |

#### 含子图层对象图层类别枚举

| 值                  | 类型   | 备注           |
| ------------------- | ------ | -------------- |
| landmarkLayer       | String | 地标图         |
| bubbleLayer         | String | 气泡图         |
| eventLayer          | String | 事件图         |
| trailLayer          | String | 轨迹图         |
| trackLayer          | String | 点迹图         |
| typeAreaLayer       | String | 类型区域图     |
| colorAreaLayer      | String | 数值区域图     |
| roadSgHeatLayer     | String | 路径段热力图   |
| 3DColumnLayer       | String | 三维柱状图     |
| 3DGridLayer         | String | 栅格图         |
| aggLandmarkLayer    | String | 聚簇地标图     |
| aggBubbleLayer      | String | 聚簇气泡图     |
| aggEventBublleLayer | String | 聚簇事件图     |
| aggHeatMapLayer     | String | 聚簇热力图     |
| agg3DColumnLayer    | String | 聚簇三维柱状图 |
| agg3DGridLayer      | String | 聚簇栅格图     |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。",
  "type": "landmark",
  "data": [
    {
      "id": "objId1"
    },
    {
      "id": "objId2"
    }
  ]
}
```

#### 回调数据参数描述

| 属性       | 类型   | 说明                     |
| ---------- | ------ | ------------------------ |
| result     | Number | 1：代表成功；0：代表失败 |
| message    | String | 成功或者失败原因         |
| type       | String | 覆盖物类别               |
| data       | Array  | 获取图层数据             |
| data[0].id | String | 子图层 id                |

[返回本章目录](#目录)
