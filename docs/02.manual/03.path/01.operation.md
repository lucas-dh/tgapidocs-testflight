# 路径操作

## 目录

- [1.添加路径](#1添加路径)
- [2.更新路径数据](#2更新路径数据)
- [3.更新路径样式](#3更新路径样式)
- [4.删除路径](#4删除路径)
- [5.添加 Shp 路径](#5添加-shp-路径)

## 1.添加路径

### 功能描述

在三维场景中添加路径

### 调用方法

```js
let jsonData = {
  id: 'path',
  name: '路径',
  coordType: 0,
  coordTypeZ: 0,
  type: 'Segment06',
  texture: 'cableFlow.png',
  textureSpeed: 0,
  color: '#ff0000',
  colorPass: '#0000FF',
  width: 40,
  tags: ['tag1', 'tag2', 'tag3'], // 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐
  label: 'label text',
  label2: 'label2 text',
  labelColor: '#ffffff',
  labelScale: 1,
  labelOffset: [0, 0, 2],
  labelBackgroundColor: '#333333',
  alpha: 1,
  autoScale: false,
  visible: true,
  cornerRadius: 0,
  cornerHideRadius: 1,
  lineDataId: 'lineDataId', // 对应本服务器上线数据对象，如果找到lineDataId，则下方的points不起作用。注意：此属性端渲染未生效
  snapSurface: 0,
  points: [
    {
      coord: [113.93067192262, 22.5055370709766], //以深圳湾经纬度为例
      coordZ: 64,
    },
    {
      coord: [113.931096391945, 22.505529293013502],
      coordZ: 64,
    },
    {
      coord: [113.931631709536, 22.505558300919404],
      coordZ: 64,
    },
    {
      coord: [113.931891370615, 22.505629814270502],
      coordZ: 64,
    },
    {
      coord: [113.932472588119, 22.506007710047],
      coordZ: 64,
    },
    {
      coord: [113.932700261644, 22.5064112673693],
      coordZ: 64,
    },
    {
      coord: [113.932918938857, 22.506912837105403],
      coordZ: 64,
    },
    {
      coord: [113.933647825522, 22.508953376710004],
      coordZ: 64,
    },
  ],
};

appInstance.uniCall('addPath', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性                 | 类型     | 说明                                                                                                                                          | 端渲染 | 流渲染 |
| -------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- | ------ | ------ |
| id                   | String   | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                                           | 支持   | 支持   |
| name                 | String   | 图层名称，支持为图层自定义名称                                                                                                                | 支持   | 支持   |
| coordType            | Number   | XY 轴坐标类别，0：X 经度，Y 纬度；1：X 米，Y 米，相对世界 00 点 目前该属性仅支持属性值为 0                                                    | 支持   | 支持   |
| coordTypeZ           | Number   | Z 轴坐标类别，0：相对 3D 世界 0 海拔；1：相对 3D 世界地表；2：相对 3D 模型表面（单位：米） 目前该属性仅支持属性值为 0                         | 支持   | 支持   |
| type                 | String   | 路线样式类别，详见下表：路线样式类别，如果为：Model 开始的类型，会生成模型，并且使用贴图                                                      | 支持   | 支持   |
| texture              | String   | 材质贴图名称，只有当 type 为 Model 开始的类型，才有用。端渲染：在场景中预置好的图片名称或外部图片 url，流渲染：服务器应用目录里的资源图片     | 支持   | 支持   |
| textureSpeed         | Number   | 材质贴图的 UV 动画速度，默认：0，0 为不运动，其他数值沿着路径模型方向前进，负数为反向                                                         | 支持   | 支持   |
| color                | String   | 路线颜色，"" 颜色透明（HEX 颜色值）；只有当 type 不为 Model 开始的类型，才有用。                                                              | 支持   | 支持   |
| colorPass            | String   | 模型对象 移动经过后的 路径颜色（HEX 颜色值）；只有当 type 不为 Model 开始的类型，才有用。                                                     | 支持   | 支持   |
| width                | Number   | 宽度(单位:米)                                                                                                                                 | 支持   | 支持   |
| tags                 | Anything | 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐                                                                                    | 不支持 | 支持   |
| label                | String   | 标签文本                                                                                                                                      | 支持   | 支持   |
| label2               | String   | 第二行标签文本                                                                                                                                | 支持   | 支持   |
| labelColor           | String   | 标签文本颜色，可选值，默认白色                                                                                                                | 支持   | 支持   |
| labelScale           | Number   | 标签文本的缩放，默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                                                | 支持   | 支持   |
| labelOffset          | Array    | 标签文本的位置偏移，默认值是[0, 0, 0]，表示相对于模型中心点的相对世界坐标的 x、y、z 偏移位置（单位：米）                                      | 支持   | 支持   |
| labelBackgroundColor | String   | 标签文本背景颜色，可选值，默认灰色                                                                                                            | 支持   | 支持   |
| alpha                | Number   | 透明度，0：完全透明；1：完全不透明，默认值 1                                                                                                  | 支持   | 支持   |
| autoScale            | Boolean  | 线是否近大远小，false，镜头无论远近，看起来线一样大，true，镜头近线粗，镜头远线细。（流渲染，当 autoScale 为 false 时，不支持点击和悬浮选中） | 支持   | 支持   |
| visible              | Boolean  | 添加当前图层时默认显示还是隐藏                                                                                                                | 支持   | 支持   |
| cornerRadius         | Number   | 拐点平滑度，取值为 0 到 4，4 最平滑，默认值为 0。                                                                                             | 支持   | 不支持 |
| cornerHideRadius     | Number   | 拐点是否显示，0 时显示所有弯曲拐点，非 0 时不显示拐点，默认值为 0。                                                                           | 支持   | 不支持 |
| lineDataId           | String   | 对应本服务器上线数据对象，如果找到 lineDataId，则下方的 points 不起作用。注意：此属性端渲染未生效                                             | 支持   | 支持   |
| snapSurface          | Number   | 启用自动贴地，0：不贴地，1：自动贴地。默认值是 0                                                                                              | 不支持 | 支持   |
| points               | Array    | 定义路径途径点                                                                                                                                | 支持   | 支持   |
| points[0].coord      | Array    | XY 轴坐标，X：经度；Y：纬度                                                                                                                   | 支持   | 支持   |
| points[0].coordZ     | Number   | Z 轴高度（单位：米）                                                                                                                          | 支持   | 支持   |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

### type 枚举值

<video id="pathSrc" src="./contents/mediaFiles/video/line/Line-Arrow-01.mp4"  autoplay loop></video>

<div class="video-wrap ">
  <ul class="video-cont path-width" >
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Arrow-01.mp4',0)">
      <video src="./contents/mediaFiles/video/line/Line-Arrow-01.mp4"></video>
      <strong>Arrow01</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Arrow-02.mp4',1)">
      <video src="./contents/mediaFiles/video/line/Line-Arrow-02.mp4"></video>
      <strong>Arrow02</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Arrow-03.mp4',2)">
      <video src="./contents/mediaFiles/video/line/Line-Arrow-03.mp4"></video>
      <strong>Arrow03</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Arrow-04.mp4',3)">
      <video src="./contents/mediaFiles/video/line/Line-Arrow-04.mp4"></video>
      <strong>Arrow04</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Arrow-05.mp4',4)">
      <video src="./contents/mediaFiles/video/line/Line-Arrow-05.mp4"></video>
      <strong>Arrow05</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Arrow-06.mp4',5)">
      <video src="./contents/mediaFiles/video/line/Line-Arrow-06.mp4"></video>
      <strong>Arrow06</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Arrow-07.mp4',6)">
      <video src="./contents/mediaFiles/video/line/Line-Arrow-07.mp4"></video>
      <strong>Arrow07</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Segment-01.mp4',7)">
      <video src="./contents/mediaFiles/video/line/Line-Segment-01.mp4"></video>
      <strong>Segment01</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Segment-02.mp4',8)">
      <video src="./contents/mediaFiles/video/line/Line-Segment-02.mp4"></video>
      <strong>Segment02</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Segment-03.mp4',9)">
      <video src="./contents/mediaFiles/video/line/Line-Segment-03.mp4"></video>
      <strong>Segment03</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Segment-04.mp4',10)">
      <video src="./contents/mediaFiles/video/line/Line-Segment-04.mp4"></video>
      <strong>Segment04</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Segment-05.mp4',11)">
      <video src="./contents/mediaFiles/video/line/Line-Segment-05.mp4"></video>
      <strong>Segment05</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Segment-06.mp4',12)">
      <video src="./contents/mediaFiles/video/line/Line-Segment-06.mp4"></video>
      <strong>Segment06</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Segment-07.mp4',13)">
      <video src="./contents/mediaFiles/video/line/Line-Segment-07.mp4"></video>
      <strong>Segment07</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/Line-Segment-08.mp4',14)">
      <video src="./contents/mediaFiles/video/line/Line-Segment-08.mp4"></video>
      <strong>Segment08</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/ModelCube .mp4',15)">
      <video src="./contents/mediaFiles/video/line/ModelCube .mp4"></video>
      <strong>ModelCube</strong>
    </li>
    <li class="video-item" onclick="switchPath('pathSrc','path-width','./contents/mediaFiles/video/line/ModelCylinder.mp4',16)">
      <video src="./contents/mediaFiles/video/line/ModelCylinder.mp4"></video>
      <strong>ModelCylinder</strong>
    </li>
  </ul>
</div>

[返回本章目录](#目录)

## 2.更新路径数据

### 功能描述

更新三维场景中添加路径的数据

### 调用方法

```js
let jsonData = {
  id: 'path',
  name: '路径',
  coordType: 0,
  coordTypeZ: 0,
  isAppend: false,
  tags: ['tag1', 'tag2', 'tag3'], // 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐
  points: [
    {
      coord: [113.935195492731, 22.511670245576504], //以深圳湾经纬度为例
      coordZ: 64,
    },
    {
      coord: [113.935040742524, 22.511205569365902],
      coordZ: 64,
    },
    {
      coord: [113.934916949514, 22.510709831450303],
      coordZ: 64,
    },
    {
      coord: [113.934837080962, 22.5104179991934],
      coordZ: 64,
    },
    {
      coord: [113.934746228014, 22.5101201885304],
      coordZ: 64,
    },
    {
      coord: [113.934628413815, 22.509803431319003],
      coordZ: 64,
    },
    {
      coord: [113.934300895417, 22.5094280879441],
      coordZ: 64,
    },
    {
      coord: [113.933958382163, 22.5092297644093],
      coordZ: 64,
    },
  ],
};

appInstance.uniCall('updatePathCoord', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性             | 类型     | 说明                                                                                                                  | 端渲染 | 流渲染 |
| ---------------- | -------- | --------------------------------------------------------------------------------------------------------------------- | ------ | ------ |
| id               | String   | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                   | 支持   | 支持   |
| name             | String   | 图层名称，支持为图层自定义名称                                                                                        | 支持   | 支持   |
| coordType        | Number   | XY 轴坐标类别，0：X 经度，Y 纬度；1：X 米，Y 米，相对世界 00 点 目前该属性仅支持属性值为 0                            | 支持   | 支持   |
| coordTypeZ       | Number   | Z 轴坐标类别，0：相对 3D 世界 0 海拔；1：相对 3D 世界地表；2：相对 3D 模型表面（单位：米） 目前该属性仅支持属性值为 0 | 支持   | 支持   |
| isAppend         | Boolean  | 是否追加数据（按数据顺序），true：在原有数据后方追加数据；false：清除原有数据，更新数据                               | 支持   | 支持   |
| tags             | Anything | 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐                                                            | 不支持 | 支持   |
| points           | Array    | 定义路径途径点                                                                                                        | 支持   | 支持   |
| points[0].coord  | Array    | XY 轴坐标，X：经度；Y：纬度                                                                                           | 支持   | 支持   |
| points[0].coordZ | Number   | Z 轴高度（单位：米）                                                                                                  | 支持   | 支持   |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 3.更新路径样式

### 功能描述

更新三维场景中添加路径的样式

### 调用方法

```js
let jsonData = {
  id: 'path',
  type: 'Segment05',
  texture: 'cableFlow',
  textureSpeed: 0,
  color: '#0000dd',
  colorPass: '#FFFF00',
  width: 50,
  label: 'label text',
  label2: 'label2 text',
  labelColor: '#ffffff',
  labelScale: 1,
  labelOffset: [0, 0, 2],
  labelBackgroundColor: '#333333',
  alpha: 0.5,
  snapSurface: 0,
};

appInstance.uniCall('updatePathStyle', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性                 | 类型   | 说明                                                                                                                                      | 端渲染 | 流渲染 |
| -------------------- | ------ | ----------------------------------------------------------------------------------------------------------------------------------------- | ------ | ------ |
| id                   | String | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                                       | 支持   | 支持   |
| type                 | String | 路线样式类别，详见下表：路线样式类别，如果为：Model 开始的类型，会生成模型，并且使用贴图                                                  | 支持   | 支持   |
| texture              | String | 材质贴图名称，只有当 type 为 Model 开始的类型，才有用。端渲染：在场景中预置好的图片名称或外部图片 url，流渲染：服务器应用目录里的资源图片 | 支持   | 支持   |
| textureSpeed         | Number | 材质贴图的 UV 动画速度，默认：0，0 为不运动，其他数值沿着路径模型方向前进，负数为反向                                                     | 支持   | 支持   |
| color                | String | 路线颜色，"" 颜色透明（HEX 颜色值）；只有当 type 不为 Model 开始的类型，才有用。                                                          | 支持   | 支持   |
| colorPass            | String | 模型对象 移动经过后的 路径颜色（HEX 颜色值）；只有当 type 不为 Model 开始的类型，才有用                                                   | 支持   | 支持   |
| width                | Number | 宽度(单位:米)                                                                                                                             | 支持   | 支持   |
| label                | String | 标签文本                                                                                                                                  | 支持   | 支持   |
| label2               | String | 第二行标签文本                                                                                                                            | 支持   | 支持   |
| labelColor           | String | 标签文本颜色，可选值，默认白色                                                                                                            | 支持   | 支持   |
| labelScale           | Number | 标签文本的缩放，默认值是 1 表示原大，0 - 1：表示缩小倍率，大于 1：表示放大倍率                                                            | 支持   | 支持   |
| labelOffset          | Array  | 标签文本的位置偏移，默认值是[0, 0, 0]，表示相对于模型中心点的相对世界坐标的 x、y、z 偏移位置（单位：米）                                  | 支持   | 支持   |
| labelBackgroundColor | String | 标签文本背景颜色，可选值，默认灰色                                                                                                        | 支持   | 支持   |
| alpha                | Number | 透明度，0：完全透明；1：完全不透明                                                                                                        | 支持   | 支持   |
| snapSurface          | Number | 启用自动贴地，0：不贴地，1：自动贴地。默认值是 0                                                                                          | 不支持 | 支持   |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)

## 4.删除路径

### 功能描述

删除路径

### 调用方法

```js
let jsonData = {
  id: 'path',
  overlayType: 'path',
};

appInstance.uniCall('removeOverlay', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性        | 类型   | 说明                                                                |
| ----------- | ------ | ------------------------------------------------------------------- |
| id          | String | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别 |
| overlayType | String | 图层对象类别                                                        |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

##### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

### 流渲染效果图

<img src="./contents/mediaFiles/images/overlay/path-streaming.png" width = "544" height="405" alt="系统架构图" />

### 端渲染效果图

<img src="./contents/mediaFiles/images/overlay/path.png" width = "544" height="405" alt="系统架构图" />

## 5.添加 Shp 路径

### 功能描述

添加 Shp 路径

### 调用方法

```js
let jsonData = {
  id: 'idPath',
  name: 'layerName',
  coordType: 0,
  coordTypeZ: 0,
  coordZ: 150,
  type: 'solid',
  color: '#ff0000',
  colorPass: '#ffff00',
  width: 10,
  tags: ['tag1', 'tag2', 'tag3'],
  shpPath: '',
  dataRegion: 'first',
};
appInstance.uniCall('addPathShp', jsonData, (result) => {
  console.log(result);
});
```

#### 参数描述

| 属性       | 类型     | 说明                                                                                                                                                                                                                                                             | 端渲染 | 流渲染 |
| ---------- | -------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ | ------ |
| id         | String   | 图层对象 id，新建时调用者自己传入的唯一标识，用于各种操作的对象识别                                                                                                                                                                                              | 支持   | 支持   |
| name       | String   | 图层名称，支持为图层自定义名称                                                                                                                                                                                                                                   | 支持   | 支持   |
| coordType  | Number   | xy 轴坐标模式 坐标类型(0:x 经度 y 纬度；1:x 米 y 米，相对世界 00 点) 目前该属性仅支持属性值为 0                                                                                                                                                                  | 支持   | 支持   |
| coordTypeZ | Number   | z 轴坐标模式 坐标高度类型，单位：米(0:相对 3D 世界 0 海拔；1:相对 3D 世界地表；2:相对 3D 模型表面) 目前该属性仅支持属性值为 0                                                                                                                                    | 支持   | 支持   |
| coordZ     | Number   | 高度(单位:米)                                                                                                                                                                                                                                                    | 支持   | 支持   |
| type       | String   | 路线样式类别 Arrow01 Arrow02 Arrow03 Arrow04 Arrow05 Arrow06 Arrow07 Segment01 Segment02 Segment03 Segment04 Segment05 Segment06 Segment07 Segment08 ModelCube ModelCylinder                                                                                     | 支持   | 支持   |
| color      | String   | 颜色(HEX 颜色值, "color":"" 透明路径)                                                                                                                                                                                                                            | 支持   | 支持   |
| colorPass  | String   | 覆盖物移动经过路径颜色(HEX 颜色值)                                                                                                                                                                                                                               | 支持   | 支持   |
| width      | Number   | 宽度(单位:米)                                                                                                                                                                                                                                                    | 支持   | 支持   |
| tags       | Anything | 用户自定标签数组，用于保存用户的扩展数据，或者可以控制显隐                                                                                                                                                                                                       | 不支持 | 支持   |
| shpPath    | Number   | shp 文件地址，端渲染，可以传入和 TGAPI.min.js 相对的 URL 路径，或者 URL 的绝对路径；流渲染，可以是本地 CustomShps 下的相对路径，根目录直接填 “test.shp”，如果是子文件夹填写"\test\test.shp"，如果是在线地址，需填写完整的 URL，例如："http://xxx.xx/xx/test.shp" | 支持   | 支持   |
| dataRegion | String   | 值为 all 或者 first ，用于区分只加载第一条还是加载全部数据，默认值是 first                                                                                                                                                                                       | 支持   | 不支持 |

#### 回调数据

```json
{
  "result": 1,
  "message": "成功。"
}
```

#### 回调数据参数描述

| 属性    | 类型   | 说明                     |
| ------- | ------ | ------------------------ |
| result  | Number | 1：代表成功；0：代表失败 |
| message | String | 成功或者失败原因         |

[返回本章目录](#目录)
